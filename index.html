<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestão Financeira Pessoal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .positive-value { color: #10B981; }
    .negative-value { color: #EF4444; }
    .input-highlight { transition: all 0.3s ease; }
    .input-highlight:focus { box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3); }
    .pulse-animation { animation: pulse 2s infinite; }
    @keyframes pulse {
      0%   { box-shadow: 0 0 0 0 rgba(16,185,129,0.4); }
      70%  { box-shadow: 0 0 0 10px rgba(16,185,129,0); }
      100% { box-shadow: 0 0 0 0 rgba(16,185,129,0); }
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="container mx-auto px-4 py-8 max-w-4xl">

    <!-- Cabeçalho -->
    <header class="mb-10 text-center">
      <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Gestão Financeira Mensal</h1>
      <p class="text-gray-600">Controle suas receitas, despesas e saiba exatamente quanto irá sobrar no período</p>
      <div class="mt-6 flex justify-center">
        <div class="relative">
          <select id="monthSelect" class="appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 pr-8 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="1">Janeiro</option>
            <option value="2">Fevereiro</option>
            <option value="3">Março</option>
            <option value="4">Abril</option>
            <option value="5">Maio</option>
            <option value="6">Junho</option>
            <option value="7">Julho</option>
            <option value="8">Agosto</option>
            <option value="9">Setembro</option>
            <option value="10">Outubro</option>
            <option value="11">Novembro</option>
            <option value="12">Dezembro</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
            <i class="fas fa-chevron-down"></i>
          </div>
        </div>
        <div class="relative ml-4">
          <select id="yearSelect" class="appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 pr-8 focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="2023">2023</option>
            <option value="2024">2024</option>
            <option value="2025" selected>2025</option>
            <option value="2026">2026</option>
            <option value="2027">2027</option>
            <option value="2028">2028</option>
          </select>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
            <i class="fas fa-chevron-down"></i>
          </div>
        </div>
      </div>
    </header>

    <!-- Resumo Financeiro -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
      <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-green-500">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-gray-500 font-medium">Total a Receber</h3>
            <p id="totalIncome" class="text-3xl font-bold text-gray-800 mt-2">R$ 0,00</p>
          </div>
          <div class="bg-green-100 p-3 rounded-full text-green-600">
            <i class="fas fa-money-bill-wave text-xl"></i>
          </div>
        </div>
      </div>
      <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-red-500">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-gray-500 font-medium">Total a Pagar</h3>
            <p id="totalExpenses" class="text-3xl font-bold text-gray-800 mt-2">R$ 0,00</p>
          </div>
          <div class="bg-red-100 p-3 rounded-full text-red-600">
            <i class="fas fa-receipt text-xl"></i>
          </div>
        </div>
      </div>
      <div id="balanceCard" class="bg-white rounded-xl shadow-md p-6 border-l-4 border-blue-500">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-gray-500 font-medium">Saldo Final</h3>
            <p id="finalBalance" class="text-3xl font-bold mt-2">R$ 0,00</p>
          </div>
          <div class="bg-blue-100 p-3 rounded-full text-blue-600">
            <i class="fas fa-wallet text-xl"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Histórico Mensal -->
    <div id="historySection" class="bg-white rounded-xl shadow-md p-6 mb-8">
      <h2 class="text-xl font-bold text-gray-800 mb-4">Histórico Mensal</h2>
      <input type="range" id="historySlider" min="0" max="0" value="0" class="w-full mb-4">
      <div class="text-center">
        <p id="historyMonth" class="font-medium text-gray-700 mb-2"></p>
        <p id="historyIncome" class="positive-value mb-1"></p>
        <p id="historyExpenses" class="negative-value mb-1"></p>
        <p id="historyBalance" class="font-bold mt-2"></p>
      </div>
    </div>

    <!-- Seção de Receitas -->
    <div class="bg-white rounded-xl shadow-md overflow-hidden mb-8">
      <div class="bg-green-600 px-6 py-4">
        <h2 class="text-xl font-bold text-white flex items-center">
          <i class="fas fa-money-bill-wave mr-3"></i>
          Receitas do Mês
        </h2>
      </div>
      <div class="p-6">
        <div id="incomeItems" class="mb-6">
          <div class="income-item flex items-center mb-4">
            <input type="text" placeholder="Descrição (ex: Salário)" class="flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 input-highlight">
            <input type="number" placeholder="Valor (R$)" class="w-32 border-t border-b border-r border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 input-highlight income-value">
            <button class="remove-income bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-r-lg transition duration-300">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
        <button id="addIncome" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg flex items-center transition duration-300">
          <i class="fas fa-plus mr-2"></i> Adicionar Receita
        </button>
      </div>
    </div>

    <!-- Seção de Despesas -->
    <div class="bg-white rounded-xl shadow-md overflow-hidden mb-8">
      <div class="bg-red-600 px-6 py-4">
        <h2 class="text-xl font-bold text-white flex items-center">
          <i class="fas fa-receipt mr-3"></i>
          Despesas do Mês
        </h2>
      </div>
      <div class="p-6">
        <div id="expenseItems" class="mb-6">
          <div class="expense-item flex items-center mb-4">
            <input type="text" placeholder="Descrição (ex: Aluguel)" class="flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 input-highlight">
            <input type="number" placeholder="Valor (R$)" class="w-32 border-t border-b border-r border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 input-highlight expense-value">
            <button class="remove-expense bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-r-lg transition duration-300">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
        <button id="addExpense" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg flex items-center transition duration-300">
          <i class="fas fa-plus mr-2"></i> Adicionar Despesa
        </button>
      </div>
    </div>

  </div><!-- /container -->

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // referências
    const monthSelect     = document.getElementById('monthSelect');
    const yearSelect      = document.getElementById('yearSelect');
    const historySlider   = document.getElementById('historySlider');
    const historyMonth    = document.getElementById('historyMonth');
    const historyIncome   = document.getElementById('historyIncome');
    const historyExpenses = document.getElementById('historyExpenses');
    const historyBalance  = document.getElementById('historyBalance');

    // montar array de períodos de maio/2025 até +3 anos
    const historyData = [];
    {
      let dt  = new Date(2025, 4); // maio = 4
      const end = new Date(dt.getFullYear() + 3, dt.getMonth());
      while (dt <= end) {
        historyData.push({
          label:    dt.toLocaleString('pt-BR',{month:'long',year:'numeric'}),
          income:   0,
          expenses: 0,
          balance:  0
        });
        dt = new Date(dt.getFullYear(), dt.getMonth() + 1);
      }
    }
    historySlider.min   = 0;
    historySlider.max   = historyData.length - 1;
    historySlider.value = 0;
    historySlider.addEventListener('input', () => {
      const d = historyData[+historySlider.value];
      historyMonth   .textContent = d.label;
      historyIncome  .textContent = 'Receitas: '  + formatMoney(d.income);
      historyExpenses.textContent = 'Despesas: '  + formatMoney(d.expenses);
      historyBalance .textContent = 'Saldo: '      + formatMoney(d.balance);
    });

    // persistência
    function saveState() {
      const incomes = Array.from(document.querySelectorAll('.income-item')).map(item => ({
        desc:  item.querySelector('input[type="text"]').value,
        value: item.querySelector('.income-value').value
      }));
      const expenses = Array.from(document.querySelectorAll('.expense-item')).map(item => ({
        desc:  item.querySelector('input[type="text"]').value,
        value: item.querySelector('.expense-value').value
      }));
      const state = {
        month:  monthSelect.value,
        year:   yearSelect.value,
        incomes,
        expenses
      };
      localStorage.setItem('financeState', JSON.stringify(state));
    }
    function loadState() {
      const raw = localStorage.getItem('financeState');
      if (!raw) return;
      const { month, year, incomes, expenses } = JSON.parse(raw);
      monthSelect.value = month;
      yearSelect.value  = year;
      document.getElementById('incomeItems').innerHTML  = '';
      document.getElementById('expenseItems').innerHTML = '';
      incomes .forEach(i => addIncomeItem(i.desc, i.value));
      expenses.forEach(e => addExpenseItem(e.desc, e.value));
    }

    // helpers de criação
    function addIncomeItem(desc = '', val = '') {
      const incomeItems = document.getElementById('incomeItems');
      const newItem = document.createElement('div');
      newItem.className = 'income-item flex items-center mb-4';
      newItem.innerHTML = `
        <input type="text" value="${desc}" placeholder="Descrição (ex: Salário)" class="flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 input-highlight">
        <input type="number" value="${val}" placeholder="Valor (R$)" class="w-32 border-t border-b border-r border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 input-highlight income-value">
        <button class="remove-income bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-r-lg transition duration-300">
          <i class="fas fa-trash"></i>
        </button>`;
      incomeItems.appendChild(newItem);
      newItem.querySelector('.remove-income').addEventListener('click', () => {
        incomeItems.removeChild(newItem);
        calculateTotals();
        saveState();
      });
      newItem.querySelector('.income-value').addEventListener('input', () => {
        calculateTotals();
        saveState();
      });
      newItem.querySelector('input[type="text"]').addEventListener('input', saveState);
    }
    function addExpenseItem(desc = '', val = '') {
      const expenseItems = document.getElementById('expenseItems');
      const newItem = document.createElement('div');
      newItem.className = 'expense-item flex items-center mb-4';
      newItem.innerHTML = `
        <input type="text" value="${desc}" placeholder="Descrição (ex: Aluguel)" class="flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 input-highlight">
        <input type="number" value="${val}" placeholder="Valor (R$)" class="w-32 border-t border-b border-r border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 input-highlight expense-value">
        <button class="remove-expense bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-r-lg transition duration-300">
          <i class="fas fa-trash"></i>
        </button>`;
      expenseItems.appendChild(newItem);
      newItem.querySelector('.remove-expense').addEventListener('click', () => {
        expenseItems.removeChild(newItem);
        calculateTotals();
        saveState();
      });
      newItem.querySelector('.expense-value').addEventListener('input', () => {
        calculateTotals();
        saveState();
      });
      newItem.querySelector('input[type="text"]').addEventListener('input', saveState);
    }

    // formatação e cálculo
    function formatMoney(v) {
      return new Intl.NumberFormat('pt-BR',{style:'currency',currency:'BRL'}).format(v);
    }
    function updateHistoryData(inc, exp) {
      const label = new Date(+yearSelect.value, monthSelect.value - 1)
        .toLocaleString('pt-BR',{month:'long',year:'numeric'});
      const idx = historyData.findIndex(e => e.label === label);
      if (idx >= 0) {
        historyData[idx].income   = inc;
        historyData[idx].expenses = exp;
        historyData[idx].balance  = inc - exp;
      }
    }
    function calculateTotals() {
      let totalIncome = 0, totalExpenses = 0;
      document.querySelectorAll('.income-value').forEach(i => totalIncome   += parseFloat(i.value)||0);
      document.querySelectorAll('.expense-value').forEach(e => totalExpenses += parseFloat(e.value)||0);
      const finalBalance = totalIncome - totalExpenses;
      document.getElementById('totalIncome'  ).textContent = formatMoney(totalIncome);
      document.getElementById('totalExpenses').textContent = formatMoney(totalExpenses);
      document.getElementById('finalBalance' ).textContent = formatMoney(finalBalance);

      const card = document.getElementById('balanceCard');
      const txt  = document.getElementById('finalBalance');
      if (finalBalance >= 0) {
        card.classList.remove('border-l-red-500');
        card.classList.add   ('border-l-green-500');
        txt .classList.remove('negative-value');
        txt .classList.add   ('positive-value');
        finalBalance>0
          ? card.classList.add   ('pulse-animation')
          : card.classList.remove('pulse-animation');
      } else {
        card.classList.remove('border-l-green-500','pulse-animation');
        card.classList.add   ('border-l-red-500');
        txt .classList.remove('positive-value');
      }

      updateHistoryData(totalIncome, totalExpenses);
      saveState();
    }

    // botões de adicionar
    document.getElementById('addIncome').addEventListener('click', () => {
      addIncomeItem();
      calculateTotals();
      saveState();
    });
    document.getElementById('addExpense').addEventListener('click', () => {
      addExpenseItem();
      calculateTotals();
      saveState();
    });

    // load inicial
    loadState();
    calculateTotals();
    historySlider.dispatchEvent(new Event('input'));
  });
  </script>
</body>
</html>
